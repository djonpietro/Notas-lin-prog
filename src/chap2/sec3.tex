% --------------------------------------------- DEFINIÇÃO ------------------------------------------
\newtheorem{def:combinação afim}{Definição}
\newtheorem{def:convex hull}{Definição}[section]
\newtheorem{def:independencia convexa}[def:convex hull]{Definição}
\newtheorem{def:simplex}[def:convex hull]{Definição}
% ---------------------------------------- PROPOSIÇÃO -----------------------------------------------

\newtheorem{prop:redundancia}[def:convex hull]{Proposição}[section]


% --------------------------------------- LEMA ---------------------------------------

\newtheorem{lemma:afim}{Lema}[section]

%------------------------------------- TEOREMA ---------------------------------------------------

\newtheorem{thm:caratheodory}{Teorema}[section]


% -------------------------------------- COROLÁRIO ----------------------------------------------

\newtheorem{cor:caratheodory}{Corolário}[section]

\section{Envoltória Convexa}

\subsection{Envoltória e Independência Convexa}

\begin{def:convex hull}
	\label{def:convex hull}
	Seja $P$ um conjunto de pontos em $\mathbb{R}^n$. Chamamos de envoltória convexa $P$, ou fecho convexo, o conjunto 
	$\conv{P}$ dado por todas as combinações convexas dos pontos de $P$
\end{def:convex hull}

Em outras referências, pode-se encontrar uma definição equivalente de que a envoltória convexa, popularmente conhecida como \textit{covex hull},
é o menor conjunto convexo que contém todos os pontos de $P$. Neste texto, usaremos a definição
destacada por ela ser mais algebricamente fecunda.

\begin{def:independencia convexa}
	Seja $P \subset \mathbb{R}^n$ é um conjunto de pontos. $P$ é convexo-independente 
	se nenhum de seus pontos pode ser dado como combinação convexa de outros dois.
\end{def:independencia convexa}

A definição acima especializa o conceito de independência linear para conjuntos convexos,
que nos será uma definição útil. Dessa forma, um conjunto convexo-dependente será aquele 
no qual há pelo menos um ponto que pode ser dado como combinação convexa de outros dois.
Outra especialização que faremos será do conceito de geradores: se um conjunto convexo
$X$ é a envoltória convexa de um conjunto $P$, então $P$ é um conjunto gerador de $X$.
Ademais, se $P$ é convexo-independente, então os pontos de $P$ são os pontos extremos
de $X$, o que especializa o conceito de base da álgebra linear para os pontos extremos.

Na Teoria de PL, nosso interesse irá se concentrar nos conjuntos convexo que são
finitamente gerados, isto é, que podem ser determinados por um conjunto finito
de pontos geradores. Exemplo de conjuntos convexos finitamente gerados são
os poliedros tridimensionais e os polígonos, enquanto que o círculo, ou a esfera,
são exemplos de conjuntos convexos que não são finitamente gerados.

\begin{figure}[h]
\centering
% Primeira figura: Polígono Convexo
\begin{subfigure}{0.45\textwidth}
	\centering
	\begin{tikzpicture}
		\draw[thick, fill=blue!20] (0,0) -- (2,1) -- (3,3) -- (1.5,4) -- (-1,3) -- cycle;
	\end{tikzpicture}
	\caption{Conjunto convexo finitamente gerado}
	\label{fig:poligono}
\end{subfigure}
\hfill
% Segunda figura: Círculo
\begin{subfigure}{0.50\textwidth}
	\centering
	\begin{tikzpicture}
		\draw[thick, fill=red!20] (0,0) circle (2);
	\end{tikzpicture}
	\caption{Conjunto convexo não finitamente gerado}
	\label{fig:circulo}
\end{subfigure}
\caption{Comparação entre um polígono convexo e um círculo.}
\end{figure} 

\begin{prop:redundancia}
	Seja $P = \{p_1, \ldots, p_m\}$ um conjunto convexo dependente e
	$P' = \{p_1, \ldots, p_k\}$ um subconjunto convexo-independente
	de $P$ com $k < m$. Então é correto dizer que
	\begin{equation*}
		\conv{P'} = \conv{P} 
	\end{equation*} 
\end{prop:redundancia}

Dado um conjunto de geradores, é fácil observar que, ao obtermos um
novo conjunto sem as redundâncias, então a envoltória convexa, como
foi definida em \ref{def:convex hull}, será exatamente a mesmas para
ambos os conjuntos. Além disso, se $P$ for um conjunto convexo
independente, então seus elementos são os pontos extremos de \(\conv{P}\),
como fora observado mais previamente.

Uma classe especial de envoltórias convexas são os \textbf{simples}
A ideia geométrica por detrás do conceito de simplex é do ``mais simples 
conjunto convexo em um espaço euclideano de dimensão finita''. Por exemplo:
o menor número de pontos necessários para delimitar uma região no plano é
3, e a região delimitada por eles é um triângulo. Já em dimensão 3, para
delimitar uma região no espaço são necessários ao menos quatro pontos,
que definirão um tetraedro. Generalizando essa primitiva, obtemos a definição.

\begin{def:simplex}
	Chama-se simplex a envoltória convexa de um conjunto de $n + 1$ pontos
	em $\mathbb{R}^n$ convexo-independente.
\end{def:simplex}

\begin{figure}[h]
	\centering
	% Primeira figura: Triângulo
	\begin{subfigure}{0.45\textwidth}
		\centering
		\begin{tikzpicture}
			\draw[thick, fill=blue!20] (0,0) -- (3,0) -- (1.5,2.5) -- cycle;
		\end{tikzpicture}
		\caption{Simplex em 2D}
		\label{fig:triangulo}
	\end{subfigure}
	\hfill
	% Segunda figura: Tetraedro em 3D
	\begin{subfigure}{0.45\textwidth}
		\centering
		\begin{tikzpicture}
			% Definição dos vértices
			\tdplotsetmaincoords{70}{120}
			\begin{scope}[tdplot_main_coords]
				% Arestas do tetraedro
				\draw[thick, fill=red!20, opacity=0.7] (0,0,0) -- (2,0,0) -- (1,1.5,1.5) -- cycle;
				\draw[thick, fill=red!30, opacity=0.7] (0,0,0) -- (1,1.5,1.5) -- (0,2,0) -- cycle;
				\draw[thick, fill=red!40, opacity=0.7] (2,0,0) -- (1,1.5,1.5) -- (0,2,0) -- cycle;
				\draw[thick] (0,0,0) -- (2,0,0) -- (0,2,0) -- cycle;
			\end{scope}
		\end{tikzpicture}
		\caption{Simplex em 3D}
		\label{fig:tetraedro}
	\end{subfigure}
	\caption{Comparação entre simplex de dimensões diferentes.}
\end{figure}

Os simplex nos permitem a mais facilmente descrever
a natureza geométrica por deterás de conjuntos convexos
finitamente gerados.

\subsection{Espaços Afim}

Antes de ir mais afundo na natureza geométrica dos conjuntos
poliédricos, iremos retornar um pouco a alguns conceitos
algébricos. Relembrando, uma das noções primárias da Álgebra Linear é a de
independência linear, donde dizemos que um conjunto de vetores
é linearmente independente se nenhum vetor poder ser dado
como combinação linear dos demais. Uma classe de combinações
lineares que nos é últil são as chamadas combinações afim

\begin{def:combinação afim}
Sejam $v_1, \ldots, v_k$ vetores do $\mathbb{R}$. $u$ é uma 
combinação afim dos vetores citados  se existem $\lambda_1, \ldots,
\lambda_k$ tal que
\begin{equation*}
	u = \sum_{i =1}^{k}\lambda_i v_i \quad \quad \sum_{i=1}^{k} \lambda_i = 1 
\end{equation*}
\end{def:combinação afim}
Portanto, combinações afim estão em um nível intermediário de
restrições sobre os pesos entre as combinações lineares
tradicionais e as combinações convexas.

As combinações lineares afim formam um conjunto fechado
chamado de \bf{subsespaço afim}, que são análogos aos 
hiperplanos lineares a menos da restrição de conterem a
origem do $\mathbb{R}^n$. 

% imagem de compração de um hiperplano linear
% e um afim

Os hiperplanos  afim, de forma análoga ao lineares, podem ser 
definidos a partir de um sistema linear na forma $Ax = b$
ou através de um conjunto de no mínimo $n$ geradores.
Um conjunto de vetores em que pelo menos um dos membros
é combinação afim dos demais é chamado de afimmente dependente.
Geometricamente, isso significa que pelo menos um dos vetores estará
no espaço afim gerado pelos demais.

É sabido que qualquer conjunto com mais de $n$ vetores em
$\mathbb{R}^n$ é linearmente dependente, mas qual será o número mínimo
de vetores em um conjunto para afirmamos com certeza que eles são
afimmente dependentes?

A envoltória convexa de dois pontos é um segmento de reta, e,
por sua vez, o subsespaço afim gerado por esses mesmos pontos é a 
a própria reta que eles definem, ou seja, obtemos o subespaço
afim gerado ao extender infinitamente o segmento de reta em
ambos os sentido. Já três pontos não colineares
definem um triângulo, que é uma figura plana, e o subsespaço afim gerado por
esses três pontos é justamnte o plano que contém esse triângulo; é como se
tivessemos expandido infinitamente a área do triângulo assim como fizemos
com o comprimento do segmento de reta anteriormente. Por conseguinte,
para obte o \textit{span} afim a partir de uma envoltória convexa, basta
extendemos infinitamente a envoltória nas direções possíveis.

Isso nos permite agora responder a questão feita mais para trás:
expandir infinitamente um simplex de dimensão $n$ que é gerado 
por $n+1$ vetores do  $\mathbb{R}^n$,
, é suficiente para obtermos todo o $\mathbb{R}^n$
e qualquer outro vetor do $\mathbb{R}^n$ pode ser dado como
combinação afim dos pontos extremos do simplex que fora expandido.
Portanto, a conclusão que chegamos é que qualquer conjunto com mais 
de $n+1$ vetores é necessariamnte afimmente independente. Esse resultado
é provado formalmente de forma mais algébrica no lema a seguir

\begin{lemma:afim}
	\label{lemma:afim}
	Se $P = \{p_1, \ldots, p_k\} \subset \mathbb{R}^n$ é um conjunto
	finito de pontos com $k > n + 1$, então existem $\mu_1, \ldots, \mu_n
	\in \mathbb{R}$ não todos nulos tal que
	\begin{equation*}
		\displaystyle\sum_{i=1}^k \mu_i p_i = 0 \quad\quad \displaystyle\sum_{i=1}^k \mu_i = 0
	\end{equation*}
	e $P$ é um conjunto afimmente dependente.
	
	\begin{proof}
		Da álgebra linear, sabemos que, se $\#P = k > n$, então $P$ é um conjunto
		linearmente dependente, o que implica dizer que há $\mu_1, \ldots, \mu_n
		\in \mathbb{R}$ não todos nulos tal que
		\[\displaystyle\sum_{i=1}^k \mu_i p_i = 0\]
		
		Além disso, observemos que o conjunto $\{p_2 - p_1, \ldots, p_k - p_1\}$
		também é linearmente dependente, portanto 
		\[\displaystyle\sum_{i=2}^k \mu_i (p_i - p_1) = 0\]
		e fazendo \(\mu_1 = -\displaystyle\sum_{i=2}^k \mu_i\)
		obtemos que
		\[\displaystyle\sum_{i=1}^k \mu_i = 0\]
	\end{proof}
\end{lemma:afim}



\subsection{Simplex e o Teorema de Carathéodory}

Antes de prosseguirmos, iremos demonstra um lema importante para um
resultado fundamental da geometria convexa: o Teorema de Carathéodory.
Enunciemos o lema

\begin{thm:caratheodory}[Carathéodory]
	Seja $P \subset \mathbb{R}^n$ um conjunto finito de pontos. Se $x \in \conv{P}$, então
	$x \in \conv{P'}$ para algum $P' \subset P$ com cardinalidade igual a $n + 1$.
	
	\begin{proof}
		Com efeito, se $x \in \conv{P}$, e $\#P = k$, então existem $\lambda_1, \ldots, \lambda_k 
		\in \mathbb{R}$ com $\lambda_i \in [0, 1]$ tal que
		\begin{equation}
		\label{eq_thm_caratheory}
		\begin{gathered}
			x = \displaystyle\sum_{i=1}^k \lambda_i p_i \\
			\displaystyle\sum_{i=1}^k \mu_i = 1
		\end{gathered}
		\end{equation}
		Se $k \leq n + 1$, então nada há a demonstrar, do contrário, o lema \ref{lemma:afim}
		garante que existem $\mu_1, \ldots, \mu_n \in \mathbb{R}$ não todos nulos tal que
		\[\displaystyle\sum_{i=1}^k \mu_i p_i = 0\]
		e como \(\alpha \displaystyle\sum_{i=1}^k \mu_i p_i = 0\) para todo $\alpha \in \mathbb{R}$
		então podemos rescrever a equação \ref{eq_thm_caratheory} como
		\begin{gather*}
			x = \displaystyle\sum_{i=1}^k \lambda_i p_i - \alpha \displaystyle\sum_{i=1}^k \mu_i p_i \\
			x = \displaystyle\sum_{i=1}^k (\lambda_i - \alpha \mu_i) p_i
		\end{gather*}
		donde temos que
		\[\displaystyle\sum_{i=1}^k (\lambda_i - \alpha \mu_i) = 1\]
		
		Agora iremos tentar escrever $x$ como uma combinação convexa de até $n + 1$ pontos.
		Para atingir esse objetivo, escolhemos $\alpha$ tal que
		\[\alpha  = \min\left\{\frac{\lambda_i}{\mu_i}\  |\  i \in \{1,\ldots, k\} \text{ e } \mu_i > 0\right\}\]
		Logo, $\alpha > 0$, e para $i \in \{1, \ldots, k\}$, temos dois casos.
		
		I - $\mu_i \geq 0$
		
		Temos que
		\[\lambda_i - \alpha \mu_i = \mu_i \left(\frac{\lambda_i}{\mu_i} - \alpha\right)\]
		e pela nossa escolha de $\alpha$, então \(\lambda_i - \alpha \mu_i \geq 0\)
		
		II - $\mu_i < 0$
		
		Uma vez que $\alpha > 0$, então $\alpha \mu_i > 0$ e, portanto,
		\(\lambda_i - \alpha \mu_i \geq 0\)
		
		digamos que $j*$ seja tal que $\alpha = \frac{\lambda_{j^*}}{\mu_{j^*}}$. Observe que
		$\lambda_{j^*} - \alpha \mu_{j^*}$, e podemos expressar $x$ como
		\[x = \displaystyle\sum_{i=1}^{j^* - 1} (\lambda_i - \alpha \mu_i)p_i + 
				\displaystyle\sum_{i=j^* + 1}^{k} (\lambda_i - \alpha \mu_i)p_i\]
		donde concluímos que $x$ pode ser escrito como combinação convexa de $k - 1$ pontos de $conv{P}$
		
		Como podemos repetir esse processo enquanto $k > n + 1$, ou seja, enquanto o lema \ref{lemma:afim}
		pode ser aplicado, então $x$ pode ser escrito como combinação convexa de até $n + 1$ pontos de $\conv{P}$.
	\end{proof}
\end{thm:caratheodory}

Para capturar o significado geométrico do Teorema de Carathéodory, poderíamos
enunciá-lo como ``um ponto qualquer num fecho convexo sempre estará no interior
de um simplex gerado por pontos desse fecho''. Ademais, se $P \subset \mathbb{R}^n$ é um conjunto
convexo-independente, então para qualquer $x \in \conv{P}$, $x$ pode ser dado
como combinação convexa de até $n + 1$ pontos de $P$, ou seja, de até $n + 1$ pontos extremos. 
Formalizemos essa conclusão como corolário do Teorema de Carathéodory.

\begin{cor:caratheodory}
	Seja $P \subset \mathbb{R}^n$ um conjunto convexo-independente. Se $x \in \conv{P}$
	então $x$ pode ser dado como combinação convexa de até $n + 1$ pontos de $P$	
\end{cor:caratheodory}

Em outras palavras, o corolário afirma que um ponto qualquer num fecho convexo
pode ser dado como combinação convexa de até $n+1$ pontos extremos.
